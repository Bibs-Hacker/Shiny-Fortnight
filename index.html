<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tech Brian Suggestions</title>
  
  <!-- PWA Icons & Manifest -->
  <link rel="manifest" href="/manifest.json"/>
  <meta name="theme-color" content="#0f0f2d"/>
  <link rel="apple-touch-icon" href="https://via.placeholder.com/192x192/0f0f2d/00ffea?text=TB"/>
  
  <!-- Firebase SDKs (modular v9+) -->
  <script type="module">
    // Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { 
      getAuth, 
      signInWithEmailAndPassword, 
      createUserWithEmailAndPassword, 
      onAuthStateChanged, 
      signOut,
      updateProfile 
    } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
    import { 
      getFirestore, 
      collection, 
      addDoc, 
      getDocs, 
      query, 
      orderBy, 
      serverTimestamp,
      doc,
      updateDoc,
      onSnapshot,
      setDoc,
      getDoc 
    } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";
    import { 
      getMessaging, 
      getToken, 
      onMessage 
    } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-messaging.js";

    // ‚îÄ‚îÄ Your Firebase Config ‚îÄ‚îÄ (REPLACE WITH YOUR OWN! Add messagingSenderId if not there)
      const firebaseConfig = {
      apiKey: "AIzaSyCwcdPhGcHb6kDhVPYJgV0lpZoWX3qSn4A",           // ‚Üê CHANGE!
      authDomain: "heartline-6bb08.firebaseapp.com",
      projectId: "heartline-6bb08",
      storageBucket: "heartline-6bb08.firebasestorage.app",
      messagingSenderId: "372851895770",
      appId: "1:372851895770:web:aac0ae1e5bdb22482c24e3",
      measurementId: "G-C51VHHGKG6"  // Optional for Analytics
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const messaging = getMessaging(app);

    // ‚îÄ‚îÄ Admin UID ‚îÄ‚îÄ (REPLACE WITH YOUR ACTUAL ADMIN UID FROM FIREBASE AUTH)
    const ADMIN_UID = 'YOUR_ADMIN_UID_HERE'; // Get this from Firebase console after creating admin user

    // Global elements
    const loginSection = document.getElementById('login-section');
    const mainApp = document.getElementById('main-app');
    const welcomeName = document.getElementById('welcome-name');
    const suggestionsList = document.getElementById('suggestions-list');
    const totalCount = document.getElementById('total-count');
    const logoutBtn = document.getElementById('logout-btn');
    const suggestionForm = document.getElementById('suggestion-form');
    const togglePassword = document.getElementById('toggle-password');
    const profilePic = document.getElementById('profile-pic');
    const notificationToggle = document.getElementById('notification-toggle');
    const inboxCard = document.getElementById('inbox-card');
    const settingsCard = document.getElementById('settings-card');
    const userManagementCard = document.getElementById('user-management-card');
    const usersList = document.getElementById('users-list');

    // Request FCM token and save to user doc
    async function requestNotifications() {
      try {
        const permission = await Notification.requestPermission();
        if (permission === 'granted') {
          const token = await getToken(messaging, { vapidKey: 'YOUR_VAPID_KEY_HERE' }); // Generate VAPID in Firebase console
          if (auth.currentUser) {
            await updateDoc(doc(db, 'users', auth.currentUser.uid), { fcmToken: token });
            console.log('FCM Token saved:', token);
          }
        }
      } catch (err) {
        console.error('FCM Error:', err);
      }
    }

    // Foreground message handler
    onMessage(messaging, (payload) => {
      console.log('Foreground message:', payload);
      const notification = new Notification(payload.notification.title, {
        body: payload.notification.body,
        icon: '/icon-192.png'
      });
      if (navigator.vibrate) navigator.vibrate(200);
    });

    // Show/hide password
    togglePassword?.addEventListener('click', () => {
      const input = document.getElementById('password');
      const type = input.type === 'password' ? 'text' : 'password';
      input.type = type;
      togglePassword.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
    });

    // Auth state listener
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        loginSection.style.display = 'none';
        mainApp.style.display = 'block';
        welcomeName.textContent = user.displayName || user.email.split('@')[0];
        profilePic.src = user.photoURL || 'https://via.placeholder.com/150/0f0f2d/00ffea?text=TB';

        // Check user role from Firestore
        const userDoc = await getDoc(doc(db, 'users', user.uid));
        const isAdmin = user.uid === ADMIN_UID || (userDoc.exists() && userDoc.data().role === 'admin');

        // Show/hide features based on role
        inboxCard.style.display = isAdmin ? 'block' : 'none';
        userManagementCard.style.display = isAdmin ? 'block' : 'none';
        settingsCard.style.display = 'block'; // Available to all

        // Load features
        if (isAdmin) {
          loadSuggestionsRealtime();
          loadUsersRealtime();
        }

        // Request notifications if enabled
        if (notificationToggle?.checked) await requestNotifications();
      } else {
        loginSection.style.display = 'flex';
        mainApp.style.display = 'none';
      }
    });

    // Login
    document.getElementById('login-form')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (error) {
        alert("Login failed: " + error.message);
      }
    });

    // Register
    document.getElementById('register-form')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('reg-email').value;
      const password = document.getElementById('reg-password').value;
      const username = document.getElementById('reg-username').value;

      try {
        const cred = await createUserWithEmailAndPassword(auth, email, password);
        await updateProfile(cred.user, { displayName: username });
        // Use setDoc with uid as doc ID
        await setDoc(doc(db, 'users', cred.user.uid), {
          username,
          email,
          role: 'user', // Default role
          fcmToken: null
        });
      } catch (error) {
        alert("Registration failed: " + error.message);
      }
    });

    // Logout
    logoutBtn?.addEventListener('click', async () => {
      await signOut(auth);
    });

    // Submit suggestion (triggers FCM to admin)
    suggestionForm?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const topic = document.getElementById('topic').value.trim();
      const suggestion = document.getElementById('suggestion-text').value.trim();

      if (!topic || !suggestion) {
        alert("Please fill in both fields!");
        return;
      }

      try {
        await addDoc(collection(db, "suggestions"), {
          username: auth.currentUser?.displayName || "Anonymous",
          topic,
          text: suggestion,
          createdAt: serverTimestamp(),
          seen: false,
          reacted: false
        });
        alert("Suggestion submitted! Thank you! üöÄ");
        suggestionForm.reset();
        // For real FCM, trigger Cloud Function here
      } catch (err) {
        alert("Error: " + err.message);
      }
    });

    // Real-time suggestions load (for admin)
    function loadSuggestionsRealtime() {
      const q = query(collection(db, "suggestions"), orderBy("createdAt", "desc"));
      onSnapshot(q, (snapshot) => {
        suggestionsList.innerHTML = '';
        totalCount.textContent = snapshot.size;

        snapshot.forEach((docSnap) => {
          const data = docSnap.data();
          const time = data.createdAt ? new Date(data.createdAt.toDate()).toLocaleString() : "‚Äî";
          
          const card = document.createElement('div');
          card.className = 'suggestion-card cyber-glitch';
          card.setAttribute('data-text', data.topic || 'Suggestion');
          card.innerHTML = `
            <div class="header">
              <div class="user-info">
                <img class="avatar" src="https://via.placeholder.com/50/0f0f2d/00ffea?text=${data.username[0].toUpperCase()}" alt="Avatar">
                <span class="username">${data.username}</span>
              </div>
              <div class="status">
                <button class="status-btn seen-btn ${data.seen ? 'active' : ''}" onclick="toggleSeen('${docSnap.id}')">Seen</button>
                <button class="status-btn react-btn ${data.reacted ? 'active' : ''}" onclick="toggleReact('${docSnap.id}')">React ‚ù§Ô∏è</button>
              </div>
            </div>
            <div class="topic neon-text">${data.topic || "General"}</div>
            <div class="text">${data.text}</div>
            <div class="time">${time}</div>
          `;
          suggestionsList.appendChild(card);
        });
      });
    }

    // Real-time users load for admin management
    function loadUsersRealtime() {
      const q = query(collection(db, "users"), orderBy("username"));
      onSnapshot(q, (snapshot) => {
        usersList.innerHTML = '';

        snapshot.forEach((docSnap) => {
          const data = docSnap.data();
          const userCard = document.createElement('div');
          userCard.className = 'user-card cyber-glitch';
          userCard.setAttribute('data-text', data.username || 'User');
          userCard.innerHTML = `
            <div class="header">
              <span class="username">${data.username}</span>
              <span class="email">(${data.email})</span>
            </div>
            <div class="role-select">
              <label>Role:</label>
              <select onchange="updateUserRole('${docSnap.id}', this.value)">
                <option value="user" ${data.role === 'user' ? 'selected' : ''}>User</option>
                <option value="admin" ${data.role === 'admin' ? 'selected' : ''}>Admin</option>
              </select>
            </div>
          `;
          usersList.appendChild(userCard);
        });
      });
    }

    // Update user role
    window.updateUserRole = async (uid, newRole) => {
      try {
        await updateDoc(doc(db, 'users', uid), { role: newRole });
        alert(`Role updated to ${newRole}!`);
      } catch (err) {
        alert("Error updating role: " + err.message);
      }
    };

    // Toggle seen
    window.toggleSeen = async (id) => {
      const ref = doc(db, "suggestions", id);
      const snap = await getDoc(ref);
      if (snap.exists()) {
        await updateDoc(ref, { seen: !snap.data().seen });
      }
    };

    // Toggle react
    window.toggleReact = async (id) => {
      const ref = doc(db, "suggestions", id);
      const snap = await getDoc(ref);
      if (snap.exists()) {
        await updateDoc(ref, { reacted: !snap.data().reacted });
      }
    };

    // Notification toggle
    notificationToggle?.addEventListener('change', async (e) => {
      if (e.target.checked) await requestNotifications();
    });

    // Service Worker registration with FCM
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => {
            messaging.useServiceWorker(reg);
            console.log('Service Worker registered');
          })
          .catch(err => console.log('Service Worker registration failed:', err));
      });
    }
  </script>

  <!-- Font Awesome for icons (real buttons) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- Inlined Cyberpunk CSS - Enhanced for Professional Layout -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap');

    :root {
      --neon-cyan: #00ffea;
      --neon-pink: #ff00ff;
      --neon-purple: #9d00ff;
      --dark-bg: #0a0a1f;
      --panel-bg: rgba(10, 10, 31, 0.8);
      --text-color: #ffffff;
      --glow-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan), 0 0 30px var(--neon-cyan);
      --glitch-time: 2s;
    }

    .cyber-body {
      font-family: 'Rajdhani', sans-serif;
      background: var(--dark-bg) url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJncmlkIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiPjxwYXRoIGQ9Ik0gNDAgMCAiIHN0cm9rZT0icmdiYSgyNTUsMCwyNTUsMC4xKSIgc3Ryb2tlLXdpZHRoPSIxIi8+PHBhdGggZD0iTSAwIDQwIEwgNDAgNDAiIHN0cm9rZT0icmdiYSgyNTUsMCwyNTUsMC4xKSIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+') repeat;
      color: var(--text-color);
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    #particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--neon-cyan);
      box-shadow: var(--glow-shadow);
      animation: float 5s infinite ease-in-out, flicker 0.5s infinite, color-shift 3s infinite;
      border-radius: 50%;
      opacity: 0.8;
    }

    @keyframes float {
      0% { transform: translateY(0) translateX(0) scale(1); }
      50% { transform: translateY(-30px) translateX(10px) scale(1.2); opacity: 0.6; }
      100% { transform: translateY(0) translateX(0) scale(1); }
    }

    @keyframes flicker {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }

    @keyframes color-shift {
      0% { background: var(--neon-cyan); box-shadow: var(--glow-shadow); }
      33% { background: var(--neon-pink); box-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink), 0 0 30px var(--neon-pink); }
      66% { background: var(--neon-purple); box-shadow: 0 0 10px var(--neon-purple), 0 0 20px var(--neon-purple), 0 0 30px var(--neon-purple); }
      100% { background: var(--neon-cyan); box-shadow: var(--glow-shadow); }
    }

    .neon-text {
      text-shadow: var(--glow-shadow);
      font-family: 'Orbitron', sans-serif;
      animation: neon-pulse 1.5s infinite alternate;
    }

    @keyframes neon-pulse {
      from { text-shadow: 0 0 5px var(--neon-cyan), 0 0 10px var(--neon-cyan), 0 0 15px var(--neon-cyan); }
      to { text-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan), 0 0 30px var(--neon-cyan); }
    }

    .glitch {
      position: relative;
      animation: glitch var(--glitch-time) infinite;
    }

    @keyframes glitch {
      0% { transform: translate(0); }
      20% { transform: translate(-3px, 3px); opacity: 0.9; }
      40% { transform: translate(-3px, -3px); opacity: 1; }
      60% { transform: translate(3px, 3px); opacity: 0.9; }
      80% { transform: translate(3px, -3px); opacity: 1; }
      100% { transform: translate(0); }
    }

    .cyber-panel {
      background: var(--panel-bg);
      border: 1px solid var(--neon-cyan);
      border-radius: 15px;
      box-shadow: var(--glow-shadow);
      padding: 30px;
      margin: 20px;
      max-width: 500px;
      width: 100%;
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
      animation: fade-in 0.5s ease-out;
    }

    @keyframes fade-in {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .cyber-panel:hover {
      box-shadow: 0 0 15px var(--neon-cyan), 0 0 30px var(--neon-cyan), 0 0 45px var(--neon-cyan);
    }

    .auth-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .neon-title {
      font-size: 2em;
      margin-bottom: 20px;
    }

    .tabs {
      display: flex;
      margin-bottom: 20px;
    }

    .tabs .tab {
      background: none;
      border: none;
      color: var(--text-color);
      padding: 10px 30px;
      cursor: pointer;
      font-size: 1.2em;
      border-bottom: 3px solid transparent;
      transition: border-bottom 0.3s, color 0.3s;
    }

    .tabs .tab:hover {
      color: var(--neon-cyan);
    }

    .tabs .tab.active {
      border-bottom: 3px solid var(--neon-cyan);
      color: var(--neon-cyan);
    }

    .auth-form {
      width: 100%;
      display: none;
      flex-direction: column;
    }

    .auth-form.active {
      display: flex;
    }

    .auth-form label {
      font-size: 1em;
      margin-bottom: 5px;
      color: var(--neon-purple);
    }

    .cyber-input, .cyber-textarea {
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--neon-purple);
      color: var(--text-color);
      padding: 12px;
      border-radius: 8px;
      width: 100%;
      margin-bottom: 15px;
      box-shadow: inset 0 0 5px var(--neon-purple);
      font-family: 'Rajdhani', sans-serif;
      font-size: 1em;
      transition: border 0.3s, box-shadow 0.3s;
    }

    .cyber-input:focus, .cyber-textarea:focus {
      border: 1px solid var(--neon-cyan);
      box-shadow: inset 0 0 10px var(--neon-cyan);
    }

    .cyber-textarea {
      resize: vertical;
      min-height: 120px;
    }

    .password-wrapper {
      position: relative;
    }

    .password-wrapper .toggle-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.2em;
    }

    .cyber-btn {
      background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink));
      border: none;
      color: var(--dark-bg);
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      text-transform: uppercase;
      box-shadow: var(--glow-shadow);
      transition: transform 0.3s, box-shadow 0.3s;
      font-size: 1em;
    }

    .cyber-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px var(--neon-cyan), 0 0 30px var(--neon-cyan), 0 0 45px var(--neon-cyan);
    }

    .cyber-btn.small {
      padding: 8px 15px;
      font-size: 0.9em;
    }

    .cyber-btn.active {
      background: linear-gradient(45deg, var(--neon-pink), var(--neon-cyan));
    }

    .contact {
      margin-top: 20px;
      text-align: center;
    }

    .contact p {
      margin-bottom: 10px;
    }

    .contact a {
      margin: 0 5px;
    }

    .main-app {
      width: 100%;
      max-width: 800px;
    }

    .neon-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 25px;
      background: var(--panel-bg);
      border-radius: 15px 15px 0 0;
      box-shadow: var(--glow-shadow);
    }

    .title {
      font-size: 1.5em;
    }

    .theme-toggle {
      position: relative;
    }

    .cyber-toggle {
      appearance: none;
      width: 50px;
      height: 25px;
      background: var(--dark-bg);
      border-radius: 25px;
      position: relative;
      cursor: pointer;
      box-shadow: inset 0 0 8px var(--neon-purple);
      transition: background 0.3s;
    }

    .cyber-toggle:checked {
      background: var(--neon-purple);
    }

    .cyber-toggle::before {
      content: '';
      position: absolute;
      width: 23px;
      height: 23px;
      background: var(--neon-cyan);
      border-radius: 50%;
      top: 1px;
      left: 1px;
      transition: 0.3s;
      box-shadow: var(--glow-shadow);
    }

    .cyber-toggle:checked::before {
      left: 26px;
      background: var(--neon-pink);
    }

    .theme-toggle label {
      position: absolute;
      top: 0;
      left: 0;
      width: 50px;
      height: 25px;
      opacity: 0;
      cursor: pointer;
    }

    .welcome-bar {
      display: flex;
      align-items: center;
      padding: 15px;
      background: var(--panel-bg);
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: var(--glow-shadow);
    }

    .profile-pic {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 3px solid var(--neon-cyan);
      margin-right: 15px;
      box-shadow: var(--glow-shadow);
      animation: avatar-glow 2s infinite alternate;
    }

    @keyframes avatar-glow {
      from { box-shadow: 0 0 5px var(--neon-cyan); }
      to { box-shadow: 0 0 15px var(--neon-cyan); }
    }

    .actions {
      margin-left: auto;
      display: flex;
      gap: 10px;
    }

    .card {
      margin-bottom: 25px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: var(--glow-shadow);
      transition: all 0.3s;
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .cyber-card {
      background: var(--panel-bg);
      border: 1px solid var(--neon-pink);
    }

    .inbox-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .suggestions-list {
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .suggestion-card {
      background: rgba(255,255,255,0.05);
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid var(--neon-purple);
      transition: box-shadow 0.3s;
    }

    .suggestion-card:hover {
      box-shadow: 0 0 15px var(--neon-purple);
    }

    .suggestion-card .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .user-info {
      display: flex;
      align-items: center;
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
      box-shadow: var(--glow-shadow);
    }

    .username {
      font-weight: bold;
      font-size: 1.1em;
    }

    .status {
      display: flex;
      gap: 10px;
    }

    .status-btn {
      background: none;
      border: 1px solid var(--neon-cyan);
      color: var(--neon-cyan);
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9em;
      transition: background 0.3s, color 0.3s;
    }

    .status-btn:hover {
      background: var(--neon-cyan);
      color: var(--dark-bg);
    }

    .status-btn.active {
      background: var(--neon-cyan);
      color: var(--dark-bg);
    }

    .topic {
      font-size: 1.2em;
      margin: 10px 0;
    }

    .text {
      margin-bottom: 10px;
      line-height: 1.5;
    }

    .time {
      font-size: 0.9em;
      color: rgba(255,255,255,0.7);
    }

    .user-card {
      background: rgba(255,255,255,0.05);
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid var(--neon-purple);
      transition: box-shadow 0.3s;
    }

    .user-card:hover {
      box-shadow: 0 0 15px var(--neon-purple);
    }

    .user-card .header {
      margin-bottom: 10px;
    }

    .email {
      color: rgba(255,255,255,0.7);
      margin-left: 10px;
    }

    .role-select {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .role-select label {
      font-size: 1em;
      color: var(--neon-purple);
    }

    .role-select select {
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--neon-cyan);
      color: var(--text-color);
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
    }

    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .setting-item label {
      font-size: 1.1em;
    }

    .bottom-nav {
      display: flex;
      justify-content: space-around;
      padding: 15px;
      background: var(--panel-bg);
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      box-shadow: var(--glow-shadow);
      z-index: 10;
    }

    .bottom-nav a {
      text-decoration: none;
      color: var(--text-color);
      display: flex;
      align-items: center;
      font-size: 1em;
      transition: color 0.3s;
    }

    .bottom-nav a:hover {
      color: var(--neon-cyan);
    }

    .cyber-nav a i {
      margin-right: 8px;
      font-size: 1.2em;
    }

    .footer-info {
      text-align: center;
      font-size: 0.9em;
      padding: 15px;
      color: rgba(255,255,255,0.7);
      margin-bottom: 80px; // Space for bottom nav
    }

    .dark-mode {
      --dark-bg: #1a1a3f;
      --panel-bg: rgba(26, 26, 63, 0.8);
      --neon-cyan: #ffea00;
      --neon-pink: #00ff9d;
      --neon-purple: #ff009d;
    }

    .cyber-glitch {
      position: relative;
    }

    .cyber-glitch::before,
    .cyber-glitch::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
    }

    .cyber-glitch::before {
      left: 2px;
      text-shadow: -2px 0 var(--neon-pink);
      animation: glitch-anim-1 2s infinite linear alternate-reverse;
    }

    .cyber-glitch::after {
      left: -2px;
      text-shadow: 2px 0 var(--neon-cyan);
      animation: glitch-anim-2 3s infinite linear alternate-reverse;
    }

    @keyframes glitch-anim-1 {
      0% { clip-path: inset(49% 0 1% 0); }
      5% { clip-path: inset(44% 0 61% 0); }
      10% { clip-path: inset(50% 0 6% 0); }
      15% { clip-path: inset(10% 0 3% 0); }
      20% { clip-path: inset(54% 0 7% 0); }
      25% { clip-path: inset(29% 0 84% 0); }
      30% { clip-path: inset(25% 0 60% 0); }
      35% { clip-path: inset(50% 0 95% 0); }
      40% { clip-path: inset(96% 0 68% 0); }
      45% { clip-path: inset(48% 0 12% 0); }
      50% { clip-path: inset(38% 0 97% 0); }
      55% { clip-path: inset(59% 0 43% 0); }
      60% { clip-path: inset(35% 0 82% 0); }
      65% { clip-path: inset(73% 0 51% 0); }
      70% { clip-path: inset(3% 0 27% 0); }
      75% { clip-path: inset(9% 0 12% 0); }
      80% { clip-path: inset(42% 0 65% 0); }
      85% { clip-path: inset(92% 0 54% 0); }
      90% { clip-path: inset(55% 0 34% 0); }
      95% { clip-path: inset(78% 0 46% 0); }
      100% { clip-path: inset(18% 0 87% 0); }
    }

    @keyframes glitch-anim-2 {
      0% { clip-path: inset(30% 0 2% 0); }
      5% { clip-path: inset(49% 0 20% 0); }
      10% { clip-path: inset(12% 0 48% 0); }
      15% { clip-path: inset(59% 0 54% 0); }
      20% { clip-path: inset(34% 0 42% 0); }
      25% { clip-path: inset(77% 0 37% 0); }
      30% { clip-path: inset(23% 0 61% 0); }
      35% { clip-path: inset(71% 0 86% 0); }
      40% { clip-path: inset(1% 0 5% 0); }
      45% { clip-path: inset(21% 0 91% 0); }
      50% { clip-path: inset(32% 0 50% 0); }
      55% { clip-path: inset(50% 0 14% 0); }
      60% { clip-path: inset(15% 0 68% 0); }
      65% { clip-path: inset(82% 0 51% 0); }
      70% { clip-path: inset(28% 0 24% 0); }
      75% { clip-path: inset(5% 0 18% 0); }
      80% { clip-path: inset(75% 0 9% 0); }
      85% { clip-path: inset(15% 0 46% 0); }
      90% { clip-path: inset(42% 0 49% 0); }
      95% { clip-path: inset(79% 0 72% 0); }
      100% { clip-path: inset(64% 0 21% 0); }
    }
  </style>
</head>
<body class="cyber-body">

  <!-- Particle Background for Cyberpunk -->
  <div id="particles"></div>

  <!-- ‚îÄ‚îÄ LOGIN / REGISTER SCREEN ‚îÄ‚îÄ -->
  <div id="login-section" class="auth-container cyber-panel">
    <div class="neon-title glitch">
      <span>Tech Brian</span> Suggestions
    </div>

    <div class="tabs">
      <button class="tab active cyber-btn" onclick="showTab('login')">Login</button>
      <button class="tab cyber-btn" onclick="showTab('register')">Register</button>
    </div>

    <!-- Login Form -->
    <form id="login-form" class="auth-form active">
      <label for="email">Username or Email</label>
      <input type="email" id="email" class="cyber-input" placeholder="Enter email or username" required/>
      <label for="password">Password</label>
      <div class="password-wrapper">
        <input type="password" id="password" class="cyber-input" placeholder="Enter password" required/>
        <button type="button" id="toggle-password" class="toggle-btn"><i class="fas fa-eye"></i></button>
      </div>
      <button type="submit" class="cyber-btn login">Login</button>
    </form>

    <!-- Register Form -->
    <form id="register-form" class="auth-form">
      <label for="reg-username">Username</label>
      <input type="text" id="reg-username" class="cyber-input" placeholder="Choose a username" required/>
      <label for="reg-email">Email</label>
      <input type="email" id="reg-email" class="cyber-input" placeholder="Enter your email" required/>
      <label for="reg-password">Password</label>
      <input type="password" id="reg-password" class="cyber-input" placeholder="Choose a password" required/>
      <button type="submit" class="cyber-btn register">Create Account</button>
    </form>

    <div class="contact">
      <p class="neon-text">Contact Tech Brian:</p>
      <a href="https://wa.me/254748950572" class="cyber-btn whatsapp"><i class="fab fa-whatsapp"></i> WhatsApp</a>
      <a href="mailto:bridah888@gmail.com" class="cyber-btn email"><i class="fas fa-envelope"></i> Email Me</a>
      <a href="tel:+254748950572" class="cyber-btn call"><i class="fas fa-phone"></i> Call Me</a>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ MAIN APP (Admin / User View) ‚îÄ‚îÄ -->
  <div id="main-app" class="main-app" style="display:none;">
    <header class="neon-header glitch">
      <div class="title">
        <i class="fas fa-lightbulb"></i> Tech Brian Suggestions
      </div>
      <div class="theme-toggle">
        <input type="checkbox" id="dark-mode-toggle" class="cyber-toggle"/>
        <label for="dark-mode-toggle"></label>
      </div>
    </header>

    <div class="welcome-bar cyber-panel">
      <img id="profile-pic" class="profile-pic" src="https://via.placeholder.com/50" alt="Profile"/>
      <h2 class="neon-text">Welcome, <span id="welcome-name">User</span>!</h2>
      <div class="actions">
        <button class="cyber-btn small">Edit Profile</button>
        <button id="logout-btn" class="cyber-btn small logout">Logout</button>
      </div>
    </div>

    <!-- Suggestion Submission (for all users) -->
    <div class="card submit-card cyber-card cyber-panel">
      <h3 class="neon-text">Submit a Suggestion</h3>
      <form id="suggestion-form">
        <label for="topic">Topic / Theme</label>
        <input type="text" id="topic" class="cyber-input" placeholder="Enter topic or theme" required/>
        <label for="suggestion-text">Your Suggestion</label>
        <textarea id="suggestion-text" class="cyber-textarea" placeholder="Describe your suggestion..." rows="5" required></textarea>
        <button type="submit" class="cyber-btn submit">Submit</button>
      </form>
    </div>

    <!-- Admin Inbox (hidden for non-admin) -->
    <div id="inbox-card" class="card inbox-card cyber-card cyber-panel" style="display: none;">
      <div class="inbox-header">
        <h3 class="neon-text">Admin Inbox</h3>
        <div class="stats neon-text">
          Total Suggestions: <span id="total-count">0</span>
        </div>
      </div>
      <div id="suggestions-list" class="suggestions-list"></div>
    </div>

    <!-- User Management (for admin only) -->
    <div id="user-management-card" class="card user-management-card cyber-card cyber-panel" style="display: none;">
      <h3 class="neon-text">User Management</h3>
      <div id="users-list" class="users-list"></div>
    </div>

    <!-- Settings Section -->
    <div id="settings-card" class="card settings-card cyber-card cyber-panel">
      <h3 class="neon-text">Settings</h3>
      <div class="setting-item">
        <label for="notification-toggle">Enable Notifications</label>
        <input type="checkbox" id="notification-toggle" class="cyber-toggle"/>
      </div>
    </div>

    <!-- Bottom Nav -->
    <nav class="bottom-nav cyber-nav">
      <a href="#" class="cyber-btn"><i class="fas fa-home"></i> Home</a>
      <a href="#" class="cyber-btn"><i class="fas fa-lightbulb"></i> My Suggestions</a>
      <a href="#" class="cyber-btn"><i class="fas fa-cog"></i> Settings</a>
      <a href="#" class="cyber-btn"><i class="fas fa-info-circle"></i> About</a>
    </nav>

    <div class="footer-info neon-text">
      PWA Installed ‚Ä¢ Notifications Enabled ‚Ä¢ Powered by Firebase
    </div>
  </div>

  <script>
    // Simple tab switcher for login/register
    function showTab(tab) {
      document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      
      document.getElementById(tab + '-form').classList.add('active');
      event.target.classList.add('active');
    }

    // Dark mode toggle
    document.getElementById('dark-mode-toggle')?.addEventListener('change', (e) => {
      document.body.classList.toggle('dark-mode', e.target.checked);
    });

    // Particle JS for background (enhanced cyberpunk particles)
    function initParticles() {
      const particles = document.getElementById('particles');
      for (let i = 0; i < 200; i++) { // More particles for denser effect
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 5 + 's';
        particle.style.animationDuration = (Math.random() * 4 + 4) + 's'; // Varied speed
        particle.style.width = (Math.random() * 2 + 1) + 'px'; // Varied size
        particle.style.height = particle.style.width;
        particles.appendChild(particle);
      }
    }
    initParticles();
  </script>
</body>
  </html>
